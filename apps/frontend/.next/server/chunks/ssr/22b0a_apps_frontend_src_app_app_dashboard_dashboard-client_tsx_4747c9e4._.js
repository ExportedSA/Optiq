module.exports=[66230,a=>{"use strict";var b=a.i(30091),c=a.i(51729);function d({dateRange:a,platform:d,attributionModel:e}){let[f,g]=(0,c.useState)(null),[h,i]=(0,c.useState)(!0);(0,c.useEffect)(()=>{j()},[a,d,e]);let j=async()=>{i(!0);try{let b=new URLSearchParams({fromDate:a.from.toISOString(),toDate:a.to.toISOString(),attributionModel:e,...d?{platform:d}:{}}),c=await fetch(`/api/dashboard/kpis?${b}`);if(c.ok){let a=await c.json();g(a)}}catch(a){console.error("Failed to fetch KPIs:",a)}finally{i(!1)}};if(h)return(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 animate-pulse",children:[(0,b.jsx)("div",{className:"h-4 bg-gray-200 rounded w-20 mb-2"}),(0,b.jsx)("div",{className:"h-8 bg-gray-200 rounded w-24"})]},c))});if(!f)return null;let k=[{label:"Total Spend",value:`$${(f.totalSpend/1e6).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:"ðŸ’°",color:"blue"},{label:"Conversions",value:f.totalConversions.toLocaleString(void 0,{maximumFractionDigits:1}),icon:"ðŸŽ¯",color:"green"},{label:"Avg CPA",value:f.avgCpa?`$${f.avgCpa.toFixed(2)}`:"N/A",icon:"ðŸ“Š",color:"purple"},{label:"Avg ROAS",value:f.avgRoas?`${f.avgRoas.toFixed(2)}x`:"N/A",icon:"ðŸ“ˆ",color:"orange"},{label:"Waste Spend",value:`$${(f.totalWaste/1e6).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`,subValue:`${f.wastePct.toFixed(1)}% of spend`,icon:"âš ï¸",color:"red"}],l={blue:"from-blue-50 to-blue-100 text-blue-900",green:"from-green-50 to-green-100 text-green-900",purple:"from-purple-50 to-purple-100 text-purple-900",orange:"from-orange-50 to-orange-100 text-orange-900",red:"from-red-50 to-red-100 text-red-900"};return(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:k.map((a,c)=>(0,b.jsxs)("div",{className:`bg-gradient-to-br ${l[a.color]} rounded-lg shadow p-6`,children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("p",{className:"text-sm font-medium opacity-80",children:a.label}),(0,b.jsx)("span",{className:"text-2xl",children:a.icon})]}),(0,b.jsx)("p",{className:"text-3xl font-bold",children:a.value}),a.subValue&&(0,b.jsx)("p",{className:"text-xs opacity-70 mt-1",children:a.subValue})]},c))})}function e({dateRange:a,platform:d,attributionModel:e}){let[f,g]=(0,c.useState)([]),[h,i]=(0,c.useState)(!0),[j,k]=(0,c.useState)("spend");(0,c.useEffect)(()=>{l()},[a,d,e]);let l=async()=>{i(!0);try{let b=new URLSearchParams({fromDate:a.from.toISOString(),toDate:a.to.toISOString(),attributionModel:e,...d?{platform:d}:{}}),c=await fetch(`/api/dashboard/time-series?${b}`);if(c.ok){let a=await c.json();g(a.data||[])}}catch(a){console.error("Failed to fetch chart data:",a)}finally{i(!1)}};if(h)return(0,b.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,b.jsxs)("div",{className:"animate-pulse",children:[(0,b.jsx)("div",{className:"h-6 bg-gray-200 rounded w-32 mb-4"}),(0,b.jsx)("div",{className:"h-64 bg-gray-200 rounded"})]})});if(0===f.length)return(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Performance Over Time"}),(0,b.jsx)("div",{className:"text-center py-12 text-gray-500",children:"No data available for the selected period"})]});let m=Math.max(...f.map(a=>"spend"===j?a.spend/1e6:"conversions"===j?a.conversions:a.waste/1e6)),n=720,o=196,p=f.map((a,b)=>{let c=60+b/(f.length-1)*n,d="spend"===j?a.spend/1e6:"conversions"===j?a.conversions:a.waste/1e6;return{x:c,y:20+o-d/m*o,value:d,date:a.date}}),q=p.map((a,b)=>`${0===b?"M":"L"} ${a.x} ${a.y}`).join(" "),r=`M 60 ${20+o} `+p.map(a=>`L ${a.x} ${a.y}`).join(" ")+` L ${60+n} ${20+o} Z`;return(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Performance Over Time"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:()=>k("spend"),className:`px-3 py-1 text-sm rounded-lg ${"spend"===j?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Spend"}),(0,b.jsx)("button",{onClick:()=>k("conversions"),className:`px-3 py-1 text-sm rounded-lg ${"conversions"===j?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Conversions"}),(0,b.jsx)("button",{onClick:()=>k("waste"),className:`px-3 py-1 text-sm rounded-lg ${"waste"===j?"bg-red-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Waste"})]})]}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("svg",{width:800,height:256,className:"w-full",children:[[0,.25,.5,.75,1].map(a=>{let c=20+o-a*o;return(0,b.jsxs)("g",{children:[(0,b.jsx)("line",{x1:60,y1:c,x2:60+n,y2:c,stroke:"#e5e7eb",strokeWidth:"1"}),(0,b.jsx)("text",{x:50,y:c+4,textAnchor:"end",fontSize:"12",fill:"#6b7280",children:"conversions"===j?(m*a).toFixed(0):`$${(m*a).toFixed(0)}`})]},a)}),(0,b.jsx)("path",{d:r,fill:"spend"===j?"rgba(59, 130, 246, 0.1)":"conversions"===j?"rgba(34, 197, 94, 0.1)":"rgba(239, 68, 68, 0.1)"}),(0,b.jsx)("path",{d:q,fill:"none",stroke:"spend"===j?"#3b82f6":"conversions"===j?"#22c55e":"#ef4444",strokeWidth:"2"}),p.map((a,c)=>(0,b.jsxs)("g",{children:[(0,b.jsx)("circle",{cx:a.x,cy:a.y,r:"4",fill:"spend"===j?"#3b82f6":"conversions"===j?"#22c55e":"#ef4444"}),(0,b.jsxs)("title",{children:[a.date,": ","conversions"===j?a.value.toFixed(1):`$${a.value.toFixed(2)}`]})]},c)),p.filter((a,b)=>b%Math.ceil(p.length/7)==0).map((a,c)=>(0,b.jsx)("text",{x:a.x,y:20+o+20,textAnchor:"middle",fontSize:"12",fill:"#6b7280",children:new Date(a.date).toLocaleDateString(void 0,{month:"short",day:"numeric"})},c))]})})]})}function f({dateRange:a,platform:d,attributionModel:e}){let[f,g]=(0,c.useState)([]),[h,i]=(0,c.useState)(!0),[j,k]=(0,c.useState)("CAMPAIGN"),[l,m]=(0,c.useState)("waste"),[n,o]=(0,c.useState)("desc");(0,c.useEffect)(()=>{p()},[a,d,e,j]);let p=async()=>{i(!0);try{let b=new URLSearchParams({fromDate:a.from.toISOString(),toDate:a.to.toISOString(),attributionModel:e,grain:j,...d?{platform:d}:{}}),c=await fetch(`/api/dashboard/campaigns?${b}`);if(c.ok){let a=await c.json();g(a.data||[])}}catch(a){console.error("Failed to fetch campaign data:",a)}finally{i(!1)}},q=a=>{l===a?o("asc"===n?"desc":"asc"):(m(a),o("desc"))},r=[...f].sort((a,b)=>{let c=0,d=0;switch(l){case"spend":c=a.spend,d=b.spend;break;case"waste":c=a.waste,d=b.waste;break;case"cpa":c=a.cpa||1/0,d=b.cpa||1/0;break;case"roas":c=a.roas||0,d=b.roas||0}return"asc"===n?c-d:d-c});return h?(0,b.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,b.jsxs)("div",{className:"animate-pulse",children:[(0,b.jsx)("div",{className:"h-6 bg-gray-200 rounded w-32 mb-4"}),(0,b.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)("div",{className:"h-12 bg-gray-200 rounded"},c))})]})}):(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,b.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Performance by ",j]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:()=>k("CAMPAIGN"),className:`px-3 py-1 text-sm rounded-lg ${"CAMPAIGN"===j?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Campaign"}),(0,b.jsx)("button",{onClick:()=>k("ADSET"),className:`px-3 py-1 text-sm rounded-lg ${"ADSET"===j?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Ad Set"}),(0,b.jsx)("button",{onClick:()=>k("AD"),className:`px-3 py-1 text-sm rounded-lg ${"AD"===j?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Ad"})]})]})}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Platform"}),(0,b.jsxs)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:text-gray-700",onClick:()=>q("spend"),children:["Spend ","spend"===l&&("asc"===n?"â†‘":"â†“")]}),(0,b.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Conversions"}),(0,b.jsxs)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:text-gray-700",onClick:()=>q("cpa"),children:["CPA ","cpa"===l&&("asc"===n?"â†‘":"â†“")]}),(0,b.jsxs)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:text-gray-700",onClick:()=>q("roas"),children:["ROAS ","roas"===l&&("asc"===n?"â†‘":"â†“")]}),(0,b.jsxs)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:text-gray-700",onClick:()=>q("waste"),children:["Waste ","waste"===l&&("asc"===n?"â†‘":"â†“")]})]})}),(0,b.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===r.length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:"No data available for the selected period"})}):r.map(a=>{let c=a.wastePct>75?"high":a.wastePct>50?"medium":a.wastePct>25?"low":"none";return(0,b.jsxs)("tr",{className:`hover:bg-gray-50 ${"high"===c?"bg-red-50":"medium"===c?"bg-orange-50":"low"===c?"bg-yellow-50":""}`,children:[(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,b.jsx)("div",{className:"text-sm font-medium text-gray-900",children:a.name})}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,b.jsx)("div",{className:"text-sm text-gray-500",children:a.platformName})}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:(0,b.jsxs)("div",{className:"text-sm text-gray-900",children:["$",(a.spend/1e6).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:(0,b.jsx)("div",{className:"text-sm text-gray-900",children:a.conversions.toLocaleString(void 0,{maximumFractionDigits:1})})}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:(0,b.jsx)("div",{className:"text-sm text-gray-900",children:a.cpa?`$${a.cpa.toFixed(2)}`:"N/A"})}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:(0,b.jsx)("div",{className:"text-sm text-gray-900",children:a.roas?`${a.roas.toFixed(2)}x`:"N/A"})}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:["$",(a.waste/1e6).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),"none"!==c&&(0,b.jsxs)("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${"high"===c?"bg-red-100 text-red-800":"medium"===c?"bg-orange-100 text-orange-800":"bg-yellow-100 text-yellow-800"}`,children:[a.wastePct.toFixed(0),"%"]})]})})]},a.id)})})]})})]})}let g=[{value:null,label:"All Platforms"},{value:"META_ADS",label:"Meta Ads"},{value:"GOOGLE_ADS",label:"Google Ads"},{value:"TIKTOK_ADS",label:"TikTok Ads"}],h=[{value:"LAST_TOUCH",label:"Last Touch"},{value:"FIRST_TOUCH",label:"First Touch"},{value:"LINEAR",label:"Linear"},{value:"TIME_DECAY",label:"Time Decay"},{value:"POSITION_BASED",label:"Position Based"}],i=[{label:"Last 7 days",days:7},{label:"Last 30 days",days:30},{label:"Last 90 days",days:90}];function j({dateRange:a,platform:d,attributionModel:e,onDateRangeChange:f,onPlatformChange:j,onAttributionModelChange:k}){let[l,m]=(0,c.useState)(!1),n=a=>a.toISOString().split("T")[0];return(0,b.jsx)("div",{className:"bg-white rounded-lg shadow p-4",children:(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,b.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Range"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[i.map(a=>(0,b.jsx)("button",{onClick:()=>{var b;let c;return b=a.days,c=new Date,void(f({from:new Date(Date.now()-24*b*36e5),to:c}),m(!1))},className:"px-3 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50",children:a.label},a.days)),(0,b.jsx)("button",{onClick:()=>m(!l),className:"px-3 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50",children:"Custom"})]}),l&&(0,b.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,b.jsx)("input",{type:"date",value:n(a.from),onChange:b=>f({from:new Date(b.target.value),to:a.to}),className:"px-3 py-2 text-sm border border-gray-300 rounded-lg"}),(0,b.jsx)("span",{className:"self-center text-gray-500",children:"to"}),(0,b.jsx)("input",{type:"date",value:n(a.to),onChange:b=>f({from:a.from,to:new Date(b.target.value)}),className:"px-3 py-2 text-sm border border-gray-300 rounded-lg"})]})]}),(0,b.jsxs)("div",{className:"w-48",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Platform"}),(0,b.jsx)("select",{value:d||"",onChange:a=>j(a.target.value||null),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:g.map(a=>(0,b.jsx)("option",{value:a.value||"",children:a.label},a.value||"all"))})]}),(0,b.jsxs)("div",{className:"w-48",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Attribution Model"}),(0,b.jsx)("select",{value:e,onChange:a=>k(a.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:h.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))})]})]})})}function k(){let[a,g]=(0,c.useState)({from:new Date(Date.now()-2592e6),to:new Date}),[h,i]=(0,c.useState)(null),[k,l]=(0,c.useState)("LAST_TOUCH"),[m,n]=(0,c.useState)(!0);return(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,b.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),(0,b.jsx)("p",{className:"text-gray-600 mt-1",children:"Track your marketing performance"})]})}),(0,b.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,b.jsx)(j,{dateRange:a,platform:h,attributionModel:k,onDateRangeChange:g,onPlatformChange:i,onAttributionModelChange:l}),(0,b.jsx)("div",{className:"mt-6",children:(0,b.jsx)(d,{dateRange:a,platform:h,attributionModel:k})}),(0,b.jsx)("div",{className:"mt-6",children:(0,b.jsx)(e,{dateRange:a,platform:h,attributionModel:k})}),(0,b.jsx)("div",{className:"mt-6",children:(0,b.jsx)(f,{dateRange:a,platform:h,attributionModel:k})})]})]})}a.s(["DashboardClient",()=>k],66230)}];

//# sourceMappingURL=22b0a_apps_frontend_src_app_app_dashboard_dashboard-client_tsx_4747c9e4._.js.map