module.exports=[26024,a=>{"use strict";var b=a.i(30091),c=a.i(51729),d=a.i(69982);function e(a){return new Intl.NumberFormat("en-US").format(a)}function f(){var a;let f=(0,d.useRouter)(),h=(0,d.useSearchParams)(),[i,j]=(0,c.useState)([]),[k,l]=(0,c.useState)(null),[m,n]=(0,c.useState)(!0),[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)("monthly"),[s,t]=(0,c.useState)(null),u=(0,c.useCallback)(async()=>{n(!0);try{let[a,b]=await Promise.all([fetch("/api/billing/plans"),fetch("/api/billing/usage")]);if(a.ok){let b=await a.json();j(b.plans??[])}if(b.ok){let a=await b.json();l(a)}}finally{n(!1)}},[]);(0,c.useEffect)(()=>{u()},[u]),(0,c.useEffect)(()=>{h?.get("success")==="true"&&(t("Your subscription has been updated successfully!"),f.replace("/app/settings/billing"),u()),h?.get("canceled")==="true"&&f.replace("/app/settings/billing")},[h,f,u]);let v=async a=>{p(a);try{let b=await fetch("/api/billing/checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tier:a,interval:q})});if(b.ok){let a=await b.json();a.checkoutUrl&&(window.location.href=a.checkoutUrl)}else{let a=await b.json();alert(a.error||"Failed to start checkout")}}finally{p(null)}},w=async()=>{try{let a=await fetch("/api/billing/portal",{method:"POST"});if(a.ok){let b=await a.json();b.portalUrl&&(window.location.href=b.portalUrl)}}catch{alert("Failed to open billing portal")}};return i.find(a=>a.tier===k?.plan)??i[0],(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-semibold tracking-tight",children:"Billing & Plans"}),(0,b.jsx)("p",{className:"mt-1 text-sm text-zinc-600",children:"Manage your subscription and view usage"})]}),k&&(0,b.jsxs)("section",{className:"rounded-xl border border-zinc-200 bg-white p-6",children:[(0,b.jsx)("h2",{className:"text-lg font-medium text-zinc-900",children:"Current Usage"}),(0,b.jsxs)("p",{className:"mt-1 text-sm text-zinc-500",children:["Billing period: ",new Date(k.periodStart).toLocaleDateString()," – ",new Date(k.periodEnd).toLocaleDateString()]}),(0,b.jsxs)("div",{className:"mt-6 grid gap-4 sm:grid-cols-3",children:[(0,b.jsx)(g,{label:"Tracked Events",current:k.usage.trackedEvents,limit:k.limits.monthlyEventLimit}),(0,b.jsx)(g,{label:"Connected Accounts",current:k.usage.connectedAccounts,limit:k.limits.maxConnectors}),(0,b.jsx)(g,{label:"Workspaces",current:k.usage.workspacesUsed,limit:k.limits.maxWorkspaces})]}),k.overages.totalOverageCents>0&&(0,b.jsxs)("div",{className:"mt-4 rounded-lg border border-yellow-200 bg-yellow-50 p-4",children:[(0,b.jsx)("div",{className:"text-sm font-medium text-yellow-800",children:"Estimated overage charges this period"}),(0,b.jsx)("div",{className:"mt-1 text-lg font-semibold text-yellow-900",children:(a=k.overages.totalOverageCents,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a/100))}),(0,b.jsxs)("div",{className:"mt-1 text-xs text-yellow-700",children:[k.overages.eventsOverage>0&&(0,b.jsxs)("span",{children:[e(k.overages.eventsOverage)," events over limit • "]}),k.overages.connectorsOverage>0&&(0,b.jsxs)("span",{children:[k.overages.connectorsOverage," connectors over limit"]})]})]})]}),(0,b.jsxs)("section",{children:[(0,b.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,b.jsx)("h2",{className:"text-lg font-medium text-zinc-900",children:"Plans"}),(0,b.jsxs)("div",{className:"flex rounded-lg border border-zinc-200 bg-zinc-50 p-1",children:[(0,b.jsx)("button",{onClick:()=>r("monthly"),className:`rounded-md px-3 py-1 text-sm font-medium transition-colors ${"monthly"===q?"bg-white text-zinc-900 shadow-sm":"text-zinc-600 hover:text-zinc-900"}`,children:"Monthly"}),(0,b.jsxs)("button",{onClick:()=>r("annual"),className:`rounded-md px-3 py-1 text-sm font-medium transition-colors ${"annual"===q?"bg-white text-zinc-900 shadow-sm":"text-zinc-600 hover:text-zinc-900"}`,children:["Annual ",(0,b.jsx)("span",{className:"text-green-600",children:"Save 20%"})]})]})]}),m?(0,b.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[1,2,3,4].map(a=>(0,b.jsx)("div",{className:"h-[400px] animate-pulse rounded-xl bg-zinc-100"},a))}):(0,b.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:i.map(a=>{let c=a.tier===k?.plan,d="monthly"===q?a.pricing.monthly:a.pricing.annualMonthly;return(0,b.jsxs)("div",{className:`relative flex flex-col rounded-xl border p-6 ${a.recommended?"border-blue-500 ring-2 ring-blue-500":"border-zinc-200"} ${c?"bg-zinc-50":"bg-white"}`,children:[a.recommended&&(0,b.jsx)("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2 rounded-full bg-blue-500 px-3 py-1 text-xs font-medium text-white",children:"Recommended"}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-zinc-900",children:a.name}),(0,b.jsx)("p",{className:"mt-1 text-sm text-zinc-500",children:a.description})]}),(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsxs)("span",{className:"text-3xl font-bold text-zinc-900",children:["$",d.toFixed(0)]}),(0,b.jsx)("span",{className:"text-zinc-500",children:"/mo"}),"annual"===q&&a.pricing.monthly>0&&(0,b.jsxs)("div",{className:"mt-1 text-xs text-zinc-500",children:["Billed annually ($",a.pricing.annual.toFixed(0),"/yr)"]})]}),(0,b.jsx)("ul",{className:"mb-6 flex-1 space-y-2",children:a.features.map((a,c)=>(0,b.jsxs)("li",{className:"flex items-start gap-2 text-sm text-zinc-600",children:[(0,b.jsx)("span",{className:"text-green-500",children:"✓"}),a]},c))}),a.overages.eventsPer10k>0&&(0,b.jsxs)("div",{className:"mb-4 rounded-lg bg-zinc-50 p-3 text-xs text-zinc-600",children:[(0,b.jsx)("div",{children:"Overages:"}),(0,b.jsxs)("div",{children:["$",a.overages.eventsPer10k.toFixed(2)," per 10k events"]}),(0,b.jsxs)("div",{children:["$",a.overages.connector.toFixed(2)," per extra connector"]})]}),(0,b.jsx)("button",{disabled:c||o===a.tier||"FREE"===a.tier,onClick:()=>v(a.tier),className:`w-full rounded-lg px-4 py-2 text-sm font-medium transition-colors ${c?"cursor-default bg-zinc-100 text-zinc-500":a.recommended?"bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50":"bg-zinc-900 text-white hover:bg-zinc-800 disabled:opacity-50"}`,children:o===a.tier?"Redirecting...":c?"Current Plan":"FREE"===a.tier?"Free":"Upgrade"})]},a.tier)})})]}),k?.plan&&"FREE"!==k.plan&&(0,b.jsxs)("section",{className:"rounded-xl border border-zinc-200 bg-white p-6",children:[(0,b.jsx)("h2",{className:"text-lg font-medium text-zinc-900",children:"Manage Subscription"}),(0,b.jsx)("p",{className:"mt-1 text-sm text-zinc-500",children:"Update payment method, view invoices, or cancel your subscription"}),(0,b.jsx)("button",{onClick:w,className:"mt-4 rounded-lg border border-zinc-300 bg-white px-4 py-2 text-sm font-medium text-zinc-700 hover:bg-zinc-50",children:"Open Billing Portal"})]}),s&&(0,b.jsx)("div",{className:"fixed bottom-4 right-4 rounded-lg border border-green-200 bg-green-50 p-4 shadow-lg",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-green-600",children:"✓"}),(0,b.jsx)("span",{className:"text-sm text-green-800",children:s}),(0,b.jsx)("button",{onClick:()=>t(null),className:"ml-2 text-green-600 hover:text-green-800",children:"×"})]})}),(0,b.jsxs)("section",{className:"rounded-xl border border-zinc-200 bg-white p-6",children:[(0,b.jsx)("h2",{className:"text-lg font-medium text-zinc-900",children:"Value Metrics"}),(0,b.jsx)("p",{className:"mt-1 text-sm text-zinc-500",children:"Your plan is based on tracked events and connected ad accounts"}),(0,b.jsxs)("div",{className:"mt-4 grid gap-4 sm:grid-cols-2",children:[(0,b.jsxs)("div",{className:"rounded-lg border border-zinc-100 p-4",children:[(0,b.jsx)("div",{className:"text-sm font-medium text-zinc-700",children:"Tracked Events"}),(0,b.jsx)("div",{className:"mt-1 text-xs text-zinc-500",children:"Every page view, conversion, and custom event counts toward your monthly limit. Overages are billed per 10,000 events."})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-zinc-100 p-4",children:[(0,b.jsx)("div",{className:"text-sm font-medium text-zinc-700",children:"Connected Ad Accounts"}),(0,b.jsx)("div",{className:"mt-1 text-xs text-zinc-500",children:"Each connected Google, Meta, TikTok, or LinkedIn ad account counts toward your connector limit. Extra connectors can be added for a monthly fee."})]})]})]})]})}function g({label:a,current:c,limit:d}){let f=-1===d,g=f?0:Math.min(100,c/d*100),h=!f&&c>d;return(0,b.jsxs)("div",{className:"rounded-lg border border-zinc-100 p-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-zinc-700",children:a}),(0,b.jsxs)("span",{className:"text-sm text-zinc-500",children:[e(c)," / ",f?"∞":e(d)]})]}),(0,b.jsx)("div",{className:"mt-2 h-2 overflow-hidden rounded-full bg-zinc-100",children:(0,b.jsx)("div",{className:`h-full rounded-full transition-all ${h?"bg-red-500":g>80?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(100,g)}%`}})}),h&&(0,b.jsxs)("div",{className:"mt-1 text-xs text-red-600",children:[e(c-d)," over limit"]})]})}a.s(["BillingClient",()=>f])}];

//# sourceMappingURL=1c0b7_windsurf-project_apps_frontend_src_app_app_settings_billing_client_tsx_0185a593._.js.map