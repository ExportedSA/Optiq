{"version":3,"sources":["../../../../../../../../../../OneDrive/Desktop/Optiq/CascadeProjects/windsurf-project/apps/frontend/src/lib/auth/authorization.ts","../../../../../../../../../../OneDrive/Desktop/Optiq/CascadeProjects/windsurf-project/apps/frontend/src/lib/auth/rbac.ts"],"sourcesContent":["import \"server-only\";\r\n\r\nimport { getServerSession } from \"next-auth\";\r\nimport { NextResponse } from \"next/server\";\r\n\r\nimport { authOptions } from \"@/lib/auth\";\r\nimport { prisma } from \"@/lib/prisma\";\r\nimport {\r\n  hasPermission,\r\n  hasAnyPermission,\r\n  isRoleAtLeast,\r\n  type WorkspaceRole,\r\n  type Permission,\r\n} from \"./rbac\";\r\n\r\n/**\r\n * Authorization Context\r\n * \r\n * Contains user, organization, and role information for authorization checks.\r\n */\r\nexport interface AuthContext {\r\n  userId: string;\r\n  organizationId: string;\r\n  role: WorkspaceRole;\r\n  email: string;\r\n}\r\n\r\nexport interface AuthResult {\r\n  authorized: boolean;\r\n  context?: AuthContext;\r\n  error?: string;\r\n  status?: number;\r\n}\r\n\r\n/**\r\n * Get authorization context for the current request\r\n * Returns null if not authenticated or no active organization\r\n */\r\nexport async function getAuthContext(): Promise<AuthContext | null> {\r\n  const session = await getServerSession(authOptions);\r\n\r\n  if (!session?.user?.id || !session?.user?.activeOrgId) {\r\n    return null;\r\n  }\r\n\r\n  const membership = await prisma.membership.findUnique({\r\n    where: {\r\n      userId_organizationId: {\r\n        userId: session.user.id,\r\n        organizationId: session.user.activeOrgId,\r\n      },\r\n    },\r\n    select: { role: true },\r\n  });\r\n\r\n  if (!membership) {\r\n    return null;\r\n  }\r\n\r\n  return {\r\n    userId: session.user.id,\r\n    organizationId: session.user.activeOrgId,\r\n    role: membership.role as WorkspaceRole,\r\n    email: session.user.email ?? \"\",\r\n  };\r\n}\r\n\r\n/**\r\n * Require authentication and return auth context\r\n */\r\nexport async function requireAuth(): Promise<AuthResult> {\r\n  const context = await getAuthContext();\r\n\r\n  if (!context) {\r\n    return {\r\n      authorized: false,\r\n      error: \"Authentication required\",\r\n      status: 401,\r\n    };\r\n  }\r\n\r\n  return {\r\n    authorized: true,\r\n    context,\r\n  };\r\n}\r\n\r\n/**\r\n * Require a specific permission\r\n */\r\nexport async function requirePermission(permission: Permission): Promise<AuthResult> {\r\n  const authResult = await requireAuth();\r\n\r\n  if (!authResult.authorized || !authResult.context) {\r\n    return authResult;\r\n  }\r\n\r\n  if (!hasPermission(authResult.context.role, permission)) {\r\n    return {\r\n      authorized: false,\r\n      context: authResult.context,\r\n      error: `Permission denied: ${permission}`,\r\n      status: 403,\r\n    };\r\n  }\r\n\r\n  return authResult;\r\n}\r\n\r\n/**\r\n * Require any of the specified permissions\r\n */\r\nexport async function requireAnyPermission(permissions: Permission[]): Promise<AuthResult> {\r\n  const authResult = await requireAuth();\r\n\r\n  if (!authResult.authorized || !authResult.context) {\r\n    return authResult;\r\n  }\r\n\r\n  if (!hasAnyPermission(authResult.context.role, permissions)) {\r\n    return {\r\n      authorized: false,\r\n      context: authResult.context,\r\n      error: `Permission denied: requires one of ${permissions.join(\", \")}`,\r\n      status: 403,\r\n    };\r\n  }\r\n\r\n  return authResult;\r\n}\r\n\r\n/**\r\n * Require a minimum role level\r\n */\r\nexport async function requireRole(minimumRole: WorkspaceRole): Promise<AuthResult> {\r\n  const authResult = await requireAuth();\r\n\r\n  if (!authResult.authorized || !authResult.context) {\r\n    return authResult;\r\n  }\r\n\r\n  if (!isRoleAtLeast(authResult.context.role, minimumRole)) {\r\n    return {\r\n      authorized: false,\r\n      context: authResult.context,\r\n      error: `Role ${minimumRole} or higher required`,\r\n      status: 403,\r\n    };\r\n  }\r\n\r\n  return authResult;\r\n}\r\n\r\n/**\r\n * Create an error response for authorization failures\r\n */\r\nexport function authErrorResponse(result: AuthResult): NextResponse {\r\n  return NextResponse.json(\r\n    { error: result.error ?? \"Unauthorized\" },\r\n    { status: result.status ?? 403 }\r\n  );\r\n}\r\n\r\n/**\r\n * Verify that a resource belongs to the user's organization\r\n * This is critical for multi-tenant isolation\r\n */\r\nexport async function verifyResourceOwnership(\r\n  context: AuthContext,\r\n  resourceType: string,\r\n  resourceId: string\r\n): Promise<boolean> {\r\n  switch (resourceType) {\r\n    case \"adAccount\":\r\n      return verifyAdAccountOwnership(context.organizationId, resourceId);\r\n    case \"campaign\":\r\n      return verifyCampaignOwnership(context.organizationId, resourceId);\r\n    case \"trackingSite\":\r\n      return verifyTrackingSiteOwnership(context.organizationId, resourceId);\r\n    case \"alertRule\":\r\n      return verifyAlertRuleOwnership(context.organizationId, resourceId);\r\n    case \"journey\":\r\n      return verifyJourneyOwnership(context.organizationId, resourceId);\r\n    default:\r\n      return false;\r\n  }\r\n}\r\n\r\nasync function verifyAdAccountOwnership(organizationId: string, resourceId: string): Promise<boolean> {\r\n  const count = await prisma.adAccount.count({\r\n    where: { id: resourceId, organizationId },\r\n  });\r\n  return count > 0;\r\n}\r\n\r\nasync function verifyCampaignOwnership(organizationId: string, resourceId: string): Promise<boolean> {\r\n  const count = await prisma.campaign.count({\r\n    where: { id: resourceId, organizationId },\r\n  });\r\n  return count > 0;\r\n}\r\n\r\nasync function verifyTrackingSiteOwnership(organizationId: string, resourceId: string): Promise<boolean> {\r\n  const count = await prisma.trackingSite.count({\r\n    where: { id: resourceId, organizationId },\r\n  });\r\n  return count > 0;\r\n}\r\n\r\nasync function verifyAlertRuleOwnership(organizationId: string, resourceId: string): Promise<boolean> {\r\n  const count = await prisma.alertRule.count({\r\n    where: { id: resourceId, organizationId },\r\n  });\r\n  return count > 0;\r\n}\r\n\r\nasync function verifyJourneyOwnership(organizationId: string, resourceId: string): Promise<boolean> {\r\n  const count = await prisma.journey.count({\r\n    where: { id: resourceId, organizationId },\r\n  });\r\n  return count > 0;\r\n}\r\n\r\n/**\r\n * Scoped query helper - ensures all queries are scoped to the user's organization\r\n * Use this to build tenant-isolated queries\r\n */\r\nexport function scopedWhere<T extends Record<string, unknown>>(\r\n  context: AuthContext,\r\n  additionalWhere?: T\r\n): T & { organizationId: string } {\r\n  return {\r\n    ...additionalWhere,\r\n    organizationId: context.organizationId,\r\n  } as T & { organizationId: string };\r\n}\r\n\r\n/**\r\n * Verify membership in an organization\r\n */\r\nexport async function verifyMembership(\r\n  userId: string,\r\n  organizationId: string\r\n): Promise<{ isMember: boolean; role?: WorkspaceRole }> {\r\n  const membership = await prisma.membership.findUnique({\r\n    where: {\r\n      userId_organizationId: {\r\n        userId,\r\n        organizationId,\r\n      },\r\n    },\r\n    select: { role: true },\r\n  });\r\n\r\n  if (!membership) {\r\n    return { isMember: false };\r\n  }\r\n\r\n  return {\r\n    isMember: true,\r\n    role: membership.role as WorkspaceRole,\r\n  };\r\n}\r\n","import \"server-only\";\r\n\r\n/**\r\n * Role-Based Access Control (RBAC)\r\n * \r\n * Workspace roles: OWNER > ADMIN > MEMBER > VIEWER\r\n * Each role inherits permissions from lower roles.\r\n */\r\n\r\nexport type WorkspaceRole = \"OWNER\" | \"ADMIN\" | \"MEMBER\" | \"VIEWER\";\r\n\r\nexport type Permission =\r\n  // Organization management\r\n  | \"org:read\"\r\n  | \"org:update\"\r\n  | \"org:delete\"\r\n  | \"org:manage_billing\"\r\n  | \"org:manage_members\"\r\n  | \"org:transfer_ownership\"\r\n  // Ad accounts & connectors\r\n  | \"connectors:read\"\r\n  | \"connectors:create\"\r\n  | \"connectors:update\"\r\n  | \"connectors:delete\"\r\n  // Campaigns & ads\r\n  | \"campaigns:read\"\r\n  | \"campaigns:create\"\r\n  | \"campaigns:update\"\r\n  | \"campaigns:delete\"\r\n  // Tracking & attribution\r\n  | \"tracking:read\"\r\n  | \"tracking:create\"\r\n  | \"tracking:update\"\r\n  | \"tracking:delete\"\r\n  // Journeys\r\n  | \"journeys:read\"\r\n  | \"journeys:create\"\r\n  | \"journeys:update\"\r\n  | \"journeys:delete\"\r\n  // Alerts\r\n  | \"alerts:read\"\r\n  | \"alerts:create\"\r\n  | \"alerts:update\"\r\n  | \"alerts:delete\"\r\n  | \"alerts:acknowledge\"\r\n  // Settings\r\n  | \"settings:read\"\r\n  | \"settings:update\"\r\n  // Reports & analytics\r\n  | \"reports:read\"\r\n  | \"reports:export\"\r\n  // API keys\r\n  | \"api_keys:read\"\r\n  | \"api_keys:create\"\r\n  | \"api_keys:delete\";\r\n\r\n/**\r\n * Permission matrix by role\r\n * Each role includes all permissions of roles below it\r\n */\r\nconst ROLE_PERMISSIONS: Record<WorkspaceRole, Permission[]> = {\r\n  VIEWER: [\r\n    \"org:read\",\r\n    \"connectors:read\",\r\n    \"campaigns:read\",\r\n    \"tracking:read\",\r\n    \"journeys:read\",\r\n    \"alerts:read\",\r\n    \"settings:read\",\r\n    \"reports:read\",\r\n  ],\r\n\r\n  MEMBER: [\r\n    // Inherits VIEWER permissions\r\n    \"org:read\",\r\n    \"connectors:read\",\r\n    \"campaigns:read\",\r\n    \"tracking:read\",\r\n    \"journeys:read\",\r\n    \"alerts:read\",\r\n    \"settings:read\",\r\n    \"reports:read\",\r\n    // Additional permissions\r\n    \"campaigns:create\",\r\n    \"campaigns:update\",\r\n    \"tracking:create\",\r\n    \"tracking:update\",\r\n    \"journeys:create\",\r\n    \"journeys:update\",\r\n    \"alerts:create\",\r\n    \"alerts:update\",\r\n    \"alerts:acknowledge\",\r\n    \"reports:export\",\r\n  ],\r\n\r\n  ADMIN: [\r\n    // Inherits MEMBER permissions\r\n    \"org:read\",\r\n    \"connectors:read\",\r\n    \"campaigns:read\",\r\n    \"tracking:read\",\r\n    \"journeys:read\",\r\n    \"alerts:read\",\r\n    \"settings:read\",\r\n    \"reports:read\",\r\n    \"campaigns:create\",\r\n    \"campaigns:update\",\r\n    \"tracking:create\",\r\n    \"tracking:update\",\r\n    \"journeys:create\",\r\n    \"journeys:update\",\r\n    \"alerts:create\",\r\n    \"alerts:update\",\r\n    \"alerts:acknowledge\",\r\n    \"reports:export\",\r\n    // Additional permissions\r\n    \"org:update\",\r\n    \"org:manage_members\",\r\n    \"connectors:create\",\r\n    \"connectors:update\",\r\n    \"connectors:delete\",\r\n    \"campaigns:delete\",\r\n    \"tracking:delete\",\r\n    \"journeys:delete\",\r\n    \"alerts:delete\",\r\n    \"settings:update\",\r\n    \"api_keys:read\",\r\n    \"api_keys:create\",\r\n    \"api_keys:delete\",\r\n  ],\r\n\r\n  OWNER: [\r\n    // All permissions\r\n    \"org:read\",\r\n    \"org:update\",\r\n    \"org:delete\",\r\n    \"org:manage_billing\",\r\n    \"org:manage_members\",\r\n    \"org:transfer_ownership\",\r\n    \"connectors:read\",\r\n    \"connectors:create\",\r\n    \"connectors:update\",\r\n    \"connectors:delete\",\r\n    \"campaigns:read\",\r\n    \"campaigns:create\",\r\n    \"campaigns:update\",\r\n    \"campaigns:delete\",\r\n    \"tracking:read\",\r\n    \"tracking:create\",\r\n    \"tracking:update\",\r\n    \"tracking:delete\",\r\n    \"journeys:read\",\r\n    \"journeys:create\",\r\n    \"journeys:update\",\r\n    \"journeys:delete\",\r\n    \"alerts:read\",\r\n    \"alerts:create\",\r\n    \"alerts:update\",\r\n    \"alerts:delete\",\r\n    \"alerts:acknowledge\",\r\n    \"settings:read\",\r\n    \"settings:update\",\r\n    \"reports:read\",\r\n    \"reports:export\",\r\n    \"api_keys:read\",\r\n    \"api_keys:create\",\r\n    \"api_keys:delete\",\r\n  ],\r\n};\r\n\r\n/**\r\n * Role hierarchy (higher index = more permissions)\r\n */\r\nconst ROLE_HIERARCHY: WorkspaceRole[] = [\"VIEWER\", \"MEMBER\", \"ADMIN\", \"OWNER\"];\r\n\r\nexport function hasPermission(role: WorkspaceRole, permission: Permission): boolean {\r\n  const permissions = ROLE_PERMISSIONS[role];\r\n  return permissions?.includes(permission) ?? false;\r\n}\r\n\r\nexport function hasAnyPermission(role: WorkspaceRole, permissions: Permission[]): boolean {\r\n  return permissions.some((p) => hasPermission(role, p));\r\n}\r\n\r\nexport function hasAllPermissions(role: WorkspaceRole, permissions: Permission[]): boolean {\r\n  return permissions.every((p) => hasPermission(role, p));\r\n}\r\n\r\nexport function getRolePermissions(role: WorkspaceRole): Permission[] {\r\n  return ROLE_PERMISSIONS[role] ?? [];\r\n}\r\n\r\nexport function isRoleAtLeast(role: WorkspaceRole, minimumRole: WorkspaceRole): boolean {\r\n  const roleIndex = ROLE_HIERARCHY.indexOf(role);\r\n  const minIndex = ROLE_HIERARCHY.indexOf(minimumRole);\r\n  return roleIndex >= minIndex;\r\n}\r\n\r\nexport function canManageRole(actorRole: WorkspaceRole, targetRole: WorkspaceRole): boolean {\r\n  // Can only manage roles below your own\r\n  const actorIndex = ROLE_HIERARCHY.indexOf(actorRole);\r\n  const targetIndex = ROLE_HIERARCHY.indexOf(targetRole);\r\n  return actorIndex > targetIndex;\r\n}\r\n\r\nexport function getAssignableRoles(actorRole: WorkspaceRole): WorkspaceRole[] {\r\n  const actorIndex = ROLE_HIERARCHY.indexOf(actorRole);\r\n  // Can assign roles below your own\r\n  return ROLE_HIERARCHY.slice(0, actorIndex);\r\n}\r\n\r\nexport function getRoleDisplayName(role: WorkspaceRole): string {\r\n  const names: Record<WorkspaceRole, string> = {\r\n    OWNER: \"Owner\",\r\n    ADMIN: \"Admin\",\r\n    MEMBER: \"Member\",\r\n    VIEWER: \"Viewer\",\r\n  };\r\n  return names[role] ?? role;\r\n}\r\n\r\nexport function getRoleDescription(role: WorkspaceRole): string {\r\n  const descriptions: Record<WorkspaceRole, string> = {\r\n    OWNER: \"Full access including billing and ownership transfer\",\r\n    ADMIN: \"Can manage members, connectors, and all settings\",\r\n    MEMBER: \"Can create and edit campaigns, tracking, and alerts\",\r\n    VIEWER: \"Read-only access to all data\",\r\n  };\r\n  return descriptions[role] ?? \"\";\r\n}\r\n"],"names":[],"mappings":"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"}