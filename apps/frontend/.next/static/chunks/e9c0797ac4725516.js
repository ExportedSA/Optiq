(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,63386,e=>{"use strict";var t=e.i(15442),a=e.i(35560),s=e.i(30320);function r({dateRange:e,platform:a,attributionModel:r}){let[l,i]=(0,s.useState)(null),[n,o]=(0,s.useState)(!0);(0,s.useEffect)(()=>{c()},[e,a,r]);let c=async()=>{o(!0);try{let t=new URLSearchParams({fromDate:e.from.toISOString(),toDate:e.to.toISOString(),attributionModel:r,...a?{platform:a}:{}}),s=await fetch(`/api/dashboard/kpis?${t}`);if(s.ok){let e=await s.json();i(e)}}catch(e){console.error("Failed to fetch KPIs:",e)}finally{o(!1)}};if(n)return(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[void 0,void 0,void 0,void 0,void 0].map((e,a)=>(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 animate-pulse",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-20 mb-2"}),(0,t.jsx)("div",{className:"h-8 bg-gray-200 rounded w-24"})]},a))});if(!l)return null;let d=[{label:"Total Spend",value:`$${(l.totalSpend/1e6).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:"ðŸ’°",color:"blue"},{label:"Conversions",value:l.totalConversions.toLocaleString(void 0,{maximumFractionDigits:1}),icon:"ðŸŽ¯",color:"green"},{label:"Avg CPA",value:l.avgCpa?`$${l.avgCpa.toFixed(2)}`:"N/A",icon:"ðŸ“Š",color:"purple"},{label:"Avg ROAS",value:l.avgRoas?`${l.avgRoas.toFixed(2)}x`:"N/A",icon:"ðŸ“ˆ",color:"orange"},{label:"Waste Spend",value:`$${(l.totalWaste/1e6).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`,subValue:`${l.wastePct.toFixed(1)}% of spend`,icon:"âš ï¸",color:"red"}],x={blue:"from-blue-50 to-blue-100 text-blue-900",green:"from-green-50 to-green-100 text-green-900",purple:"from-purple-50 to-purple-100 text-purple-900",orange:"from-orange-50 to-orange-100 text-orange-900",red:"from-red-50 to-red-100 text-red-900"};return(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:d.map((e,a)=>(0,t.jsxs)("div",{className:`bg-gradient-to-br ${x[e.color]} rounded-lg shadow p-6`,children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("p",{className:"text-sm font-medium opacity-80",children:e.label}),(0,t.jsx)("span",{className:"text-2xl",children:e.icon})]}),(0,t.jsx)("p",{className:"text-3xl font-bold",children:e.value}),e.subValue&&(0,t.jsx)("p",{className:"text-xs opacity-70 mt-1",children:e.subValue})]},a))})}function l({dateRange:e,platform:a,attributionModel:r}){let[l,i]=(0,s.useState)([]),[n,o]=(0,s.useState)(!0),[c,d]=(0,s.useState)("spend");(0,s.useEffect)(()=>{x()},[e,a,r]);let x=async()=>{o(!0);try{let t=new URLSearchParams({fromDate:e.from.toISOString(),toDate:e.to.toISOString(),attributionModel:r,...a?{platform:a}:{}}),s=await fetch(`/api/dashboard/time-series?${t}`);if(s.ok){let e=await s.json();i(e.data||[])}}catch(e){console.error("Failed to fetch chart data:",e)}finally{o(!1)}};if(n)return(0,t.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,t.jsxs)("div",{className:"animate-pulse",children:[(0,t.jsx)("div",{className:"h-6 bg-gray-200 rounded w-32 mb-4"}),(0,t.jsx)("div",{className:"h-64 bg-gray-200 rounded"})]})});if(0===l.length)return(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Performance Over Time"}),(0,t.jsx)("div",{className:"text-center py-12 text-gray-500",children:"No data available for the selected period"})]});let m=Math.max(...l.map(e=>"spend"===c?e.spend/1e6:"conversions"===c?e.conversions:e.waste/1e6)),g=720,h=196,p=l.map((e,t)=>{let a=60+t/(l.length-1)*g,s="spend"===c?e.spend/1e6:"conversions"===c?e.conversions:e.waste/1e6;return{x:a,y:20+h-s/m*h,value:s,date:e.date}}),u=p.map((e,t)=>`${0===t?"M":"L"} ${e.x} ${e.y}`).join(" "),b=`M 60 ${20+h} `+p.map(e=>`L ${e.x} ${e.y}`).join(" ")+` L ${60+g} ${20+h} Z`;return(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Performance Over Time"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>d("spend"),className:`px-3 py-1 text-sm rounded-lg ${"spend"===c?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Spend"}),(0,t.jsx)("button",{onClick:()=>d("conversions"),className:`px-3 py-1 text-sm rounded-lg ${"conversions"===c?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Conversions"}),(0,t.jsx)("button",{onClick:()=>d("waste"),className:`px-3 py-1 text-sm rounded-lg ${"waste"===c?"bg-red-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Waste"})]})]}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("svg",{width:800,height:256,className:"w-full",children:[[0,.25,.5,.75,1].map(e=>{let a=20+h-e*h;return(0,t.jsxs)("g",{children:[(0,t.jsx)("line",{x1:60,y1:a,x2:60+g,y2:a,stroke:"#e5e7eb",strokeWidth:"1"}),(0,t.jsx)("text",{x:50,y:a+4,textAnchor:"end",fontSize:"12",fill:"#6b7280",children:"conversions"===c?(m*e).toFixed(0):`$${(m*e).toFixed(0)}`})]},e)}),(0,t.jsx)("path",{d:b,fill:"spend"===c?"rgba(59, 130, 246, 0.1)":"conversions"===c?"rgba(34, 197, 94, 0.1)":"rgba(239, 68, 68, 0.1)"}),(0,t.jsx)("path",{d:u,fill:"none",stroke:"spend"===c?"#3b82f6":"conversions"===c?"#22c55e":"#ef4444",strokeWidth:"2"}),p.map((e,a)=>(0,t.jsxs)("g",{children:[(0,t.jsx)("circle",{cx:e.x,cy:e.y,r:"4",fill:"spend"===c?"#3b82f6":"conversions"===c?"#22c55e":"#ef4444"}),(0,t.jsxs)("title",{children:[e.date,": ","conversions"===c?e.value.toFixed(1):`$${e.value.toFixed(2)}`]})]},a)),p.filter((e,t)=>t%Math.ceil(p.length/7)==0).map((e,a)=>(0,t.jsx)("text",{x:e.x,y:20+h+20,textAnchor:"middle",fontSize:"12",fill:"#6b7280",children:new Date(e.date).toLocaleDateString(void 0,{month:"short",day:"numeric"})},a))]})})]})}function i({dateRange:e,platform:a,attributionModel:r}){let[l,i]=(0,s.useState)([]),[n,o]=(0,s.useState)(!0),[c,d]=(0,s.useState)("CAMPAIGN"),[x,m]=(0,s.useState)("waste"),[g,h]=(0,s.useState)("desc");(0,s.useEffect)(()=>{p()},[e,a,r,c]);let p=async()=>{o(!0);try{let t=new URLSearchParams({fromDate:e.from.toISOString(),toDate:e.to.toISOString(),attributionModel:r,grain:c,...a?{platform:a}:{}}),s=await fetch(`/api/dashboard/campaigns?${t}`);if(s.ok){let e=await s.json();i(e.data||[])}}catch(e){console.error("Failed to fetch campaign data:",e)}finally{o(!1)}},u=e=>{x===e?h("asc"===g?"desc":"asc"):(m(e),h("desc"))},b=[...l].sort((e,t)=>{let a=0,s=0;switch(x){case"spend":a=e.spend,s=t.spend;break;case"waste":a=e.waste,s=t.waste;break;case"cpa":a=e.cpa||1/0,s=t.cpa||1/0;break;case"roas":a=e.roas||0,s=t.roas||0}return"asc"===g?a-s:s-a});return n?(0,t.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,t.jsxs)("div",{className:"animate-pulse",children:[(0,t.jsx)("div",{className:"h-6 bg-gray-200 rounded w-32 mb-4"}),(0,t.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0,void 0,void 0].map((e,a)=>(0,t.jsx)("div",{className:"h-12 bg-gray-200 rounded"},a))})]})}):(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,t.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Performance by ",c]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>d("CAMPAIGN"),className:`px-3 py-1 text-sm rounded-lg ${"CAMPAIGN"===c?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Campaign"}),(0,t.jsx)("button",{onClick:()=>d("ADSET"),className:`px-3 py-1 text-sm rounded-lg ${"ADSET"===c?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Ad Set"}),(0,t.jsx)("button",{onClick:()=>d("AD"),className:`px-3 py-1 text-sm rounded-lg ${"AD"===c?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Ad"})]})]})}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Platform"}),(0,t.jsxs)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:text-gray-700",onClick:()=>u("spend"),children:["Spend ","spend"===x&&("asc"===g?"â†‘":"â†“")]}),(0,t.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Conversions"}),(0,t.jsxs)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:text-gray-700",onClick:()=>u("cpa"),children:["CPA ","cpa"===x&&("asc"===g?"â†‘":"â†“")]}),(0,t.jsxs)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:text-gray-700",onClick:()=>u("roas"),children:["ROAS ","roas"===x&&("asc"===g?"â†‘":"â†“")]}),(0,t.jsxs)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:text-gray-700",onClick:()=>u("waste"),children:["Waste ","waste"===x&&("asc"===g?"â†‘":"â†“")]})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===b.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:"No data available for the selected period"})}):b.map(e=>{let a=e.wastePct>75?"high":e.wastePct>50?"medium":e.wastePct>25?"low":"none";return(0,t.jsxs)("tr",{className:`hover:bg-gray-50 ${"high"===a?"bg-red-50":"medium"===a?"bg-orange-50":"low"===a?"bg-yellow-50":""}`,children:[(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsx)("div",{className:"text-sm text-gray-500",children:e.platformName})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:(0,t.jsxs)("div",{className:"text-sm text-gray-900",children:["$",(e.spend/1e6).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:(0,t.jsx)("div",{className:"text-sm text-gray-900",children:e.conversions.toLocaleString(void 0,{maximumFractionDigits:1})})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:(0,t.jsx)("div",{className:"text-sm text-gray-900",children:e.cpa?`$${e.cpa.toFixed(2)}`:"N/A"})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:(0,t.jsx)("div",{className:"text-sm text-gray-900",children:e.roas?`${e.roas.toFixed(2)}x`:"N/A"})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:(0,t.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,t.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:["$",(e.waste/1e6).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),"none"!==a&&(0,t.jsxs)("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${"high"===a?"bg-red-100 text-red-800":"medium"===a?"bg-orange-100 text-orange-800":"bg-yellow-100 text-yellow-800"}`,children:[e.wastePct.toFixed(0),"%"]})]})})]},e.id)})})]})})]})}let n=[{value:null,label:"All Platforms"},{value:"META_ADS",label:"Meta Ads"},{value:"GOOGLE_ADS",label:"Google Ads"},{value:"TIKTOK_ADS",label:"TikTok Ads"}],o=[{value:"LAST_TOUCH",label:"Last Touch"},{value:"FIRST_TOUCH",label:"First Touch"},{value:"LINEAR",label:"Linear"},{value:"TIME_DECAY",label:"Time Decay"},{value:"POSITION_BASED",label:"Position Based"}],c=[{label:"Last 7 days",days:7},{label:"Last 30 days",days:30},{label:"Last 90 days",days:90}];function d(e){let r,l,i,d,h,p,u,b,y,v,f,j,N,w,S,A,D=(0,a.c)(35),{dateRange:C,platform:k,attributionModel:$,onDateRangeChange:T,onPlatformChange:F,onAttributionModelChange:P}=e,[L,_]=(0,s.useState)(!1);D[0]!==T?(r=e=>{let t=new Date;T({from:new Date(Date.now()-24*e*36e5),to:t}),_(!1)},D[0]=T,D[1]=r):r=D[1];let O=r,I=g;D[2]===Symbol.for("react.memo_cache_sentinel")?(l=(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Range"}),D[2]=l):l=D[2],D[3]!==O?(i=c.map(e=>(0,t.jsx)("button",{onClick:()=>O(e.days),className:"px-3 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50",children:e.label},e.days)),D[3]=O,D[4]=i):i=D[4],D[5]!==L?(d=(0,t.jsx)("button",{onClick:()=>_(!L),className:"px-3 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50",children:"Custom"}),D[5]=L,D[6]=d):d=D[6],D[7]!==i||D[8]!==d?(h=(0,t.jsxs)("div",{className:"flex gap-2",children:[i,d]}),D[7]=i,D[8]=d,D[9]=h):h=D[9],D[10]!==C||D[11]!==T||D[12]!==L?(p=L&&(0,t.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,t.jsx)("input",{type:"date",value:I(C.from),onChange:e=>T({from:new Date(e.target.value),to:C.to}),className:"px-3 py-2 text-sm border border-gray-300 rounded-lg"}),(0,t.jsx)("span",{className:"self-center text-gray-500",children:"to"}),(0,t.jsx)("input",{type:"date",value:I(C.to),onChange:e=>T({from:C.from,to:new Date(e.target.value)}),className:"px-3 py-2 text-sm border border-gray-300 rounded-lg"})]}),D[10]=C,D[11]=T,D[12]=L,D[13]=p):p=D[13],D[14]!==h||D[15]!==p?(u=(0,t.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[l,h,p]}),D[14]=h,D[15]=p,D[16]=u):u=D[16],D[17]===Symbol.for("react.memo_cache_sentinel")?(b=(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Platform"}),D[17]=b):b=D[17];let R=k||"";return D[18]!==F?(y=e=>F(e.target.value||null),D[18]=F,D[19]=y):y=D[19],D[20]===Symbol.for("react.memo_cache_sentinel")?(v=n.map(m),D[20]=v):v=D[20],D[21]!==y||D[22]!==R?(f=(0,t.jsxs)("div",{className:"w-48",children:[b,(0,t.jsx)("select",{value:R,onChange:y,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:v})]}),D[21]=y,D[22]=R,D[23]=f):f=D[23],D[24]===Symbol.for("react.memo_cache_sentinel")?(j=(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Attribution Model"}),D[24]=j):j=D[24],D[25]!==P?(N=e=>P(e.target.value),D[25]=P,D[26]=N):N=D[26],D[27]===Symbol.for("react.memo_cache_sentinel")?(w=o.map(x),D[27]=w):w=D[27],D[28]!==$||D[29]!==N?(S=(0,t.jsxs)("div",{className:"w-48",children:[j,(0,t.jsx)("select",{value:$,onChange:N,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:w})]}),D[28]=$,D[29]=N,D[30]=S):S=D[30],D[31]!==f||D[32]!==S||D[33]!==u?(A=(0,t.jsx)("div",{className:"bg-white rounded-lg shadow p-4",children:(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[u,f,S]})}),D[31]=f,D[32]=S,D[33]=u,D[34]=A):A=D[34],A}function x(e){return(0,t.jsx)("option",{value:e.value,children:e.label},e.value)}function m(e){return(0,t.jsx)("option",{value:e.value||"",children:e.label},e.value||"all")}function g(e){return e.toISOString().split("T")[0]}function h(){let e,n,o,c,x,m,g,h=(0,a.c)(23);h[0]===Symbol.for("react.memo_cache_sentinel")?(e={from:new Date(Date.now()-2592e6),to:new Date},h[0]=e):e=h[0];let[p,u]=(0,s.useState)(e),[b,y]=(0,s.useState)(null),[v,f]=(0,s.useState)("LAST_TOUCH");return(0,s.useState)(!0),h[1]===Symbol.for("react.memo_cache_sentinel")?(n=(0,t.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),(0,t.jsx)("p",{className:"text-gray-600 mt-1",children:"Track your marketing performance"})]})}),h[1]=n):n=h[1],h[2]!==v||h[3]!==p||h[4]!==b?(o=(0,t.jsx)(d,{dateRange:p,platform:b,attributionModel:v,onDateRangeChange:u,onPlatformChange:y,onAttributionModelChange:f}),h[2]=v,h[3]=p,h[4]=b,h[5]=o):o=h[5],h[6]!==v||h[7]!==p||h[8]!==b?(c=(0,t.jsx)("div",{className:"mt-6",children:(0,t.jsx)(r,{dateRange:p,platform:b,attributionModel:v})}),h[6]=v,h[7]=p,h[8]=b,h[9]=c):c=h[9],h[10]!==v||h[11]!==p||h[12]!==b?(x=(0,t.jsx)("div",{className:"mt-6",children:(0,t.jsx)(l,{dateRange:p,platform:b,attributionModel:v})}),h[10]=v,h[11]=p,h[12]=b,h[13]=x):x=h[13],h[14]!==v||h[15]!==p||h[16]!==b?(m=(0,t.jsx)("div",{className:"mt-6",children:(0,t.jsx)(i,{dateRange:p,platform:b,attributionModel:v})}),h[14]=v,h[15]=p,h[16]=b,h[17]=m):m=h[17],h[18]!==o||h[19]!==c||h[20]!==x||h[21]!==m?(g=(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[n,(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[o,c,x,m]})]}),h[18]=o,h[19]=c,h[20]=x,h[21]=m,h[22]=g):g=h[22],g}e.s(["DashboardClient",()=>h],63386)}]);