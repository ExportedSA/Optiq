(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,13185,e=>{"use strict";var t=e.i(15442),s=e.i(30320),l=e.i(35560);function a(e){let a,i,d,n,o,c,x,g,m,b,u,h,p,y,v,j,f,N,w=(0,l.c)(51),{alert:C,onStatusUpdate:D}=e,[S,E]=(0,s.useState)(!1),[R,A]=(0,s.useState)(!1);w[0]!==C.id||w[1]!==D?(a=async e=>{A(!0),await D(C.id,e),A(!1)},w[0]=C.id,w[1]=D,w[2]=a):a=w[2];let k=a;w[3]===Symbol.for("react.memo_cache_sentinel")?(i={CRITICAL:{bg:"bg-red-50",border:"border-red-200",badge:"bg-red-100 text-red-800",icon:"\uD83D\uDD34"},WARNING:{bg:"bg-orange-50",border:"border-orange-200",badge:"bg-orange-100 text-orange-800",icon:"⚠️"},INFO:{bg:"bg-blue-50",border:"border-blue-200",badge:"bg-blue-100 text-blue-800",icon:"ℹ️"}},w[3]=i):i=w[3];let I=i;w[4]===Symbol.for("react.memo_cache_sentinel")?(d={TRIGGERED:{badge:"bg-red-100 text-red-800",label:"Active"},ACKNOWLEDGED:{badge:"bg-yellow-100 text-yellow-800",label:"Acknowledged"},RESOLVED:{badge:"bg-green-100 text-green-800",label:"Resolved"},DISMISSED:{badge:"bg-gray-100 text-gray-800",label:"Dismissed"}},w[4]=d):d=w[4];let G=d,L=I[C.severity],T=G[C.status],$=`bg-white rounded-lg shadow border-l-4 ${L.border} ${L.bg} transition-all`;w[5]!==L.icon?(n=(0,t.jsx)("span",{className:"text-2xl",children:L.icon}),w[5]=L.icon,w[6]=n):n=w[6];let O=`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${L.badge}`;w[7]!==C.severity||w[8]!==O?(o=(0,t.jsx)("span",{className:O,children:C.severity}),w[7]=C.severity,w[8]=O,w[9]=o):o=w[9];let F=`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${T.badge}`;return w[10]!==T.label||w[11]!==F?(c=(0,t.jsx)("span",{className:F,children:T.label}),w[10]=T.label,w[11]=F,w[12]=c):c=w[12],w[13]!==C.triggeredAt?(x=function(e){let t=new Date(e),s=new Date().getTime()-t.getTime(),l=Math.floor(s/6e4),a=Math.floor(s/36e5),r=Math.floor(s/864e5);return l<1?"Just now":l<60?`${l}m ago`:a<24?`${a}h ago`:r<7?`${r}d ago`:t.toLocaleDateString()}(C.triggeredAt),w[13]=C.triggeredAt,w[14]=x):x=w[14],w[15]!==x?(g=(0,t.jsx)("span",{className:"text-xs text-gray-500",children:x}),w[15]=x,w[16]=g):g=w[16],w[17]!==g||w[18]!==o||w[19]!==c?(m=(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[o,c,g]}),w[17]=g,w[18]=o,w[19]=c,w[20]=m):m=w[20],w[21]!==C.title?(b=(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:C.title}),w[21]=C.title,w[22]=b):b=w[22],w[23]!==C.message?(u=(0,t.jsx)("p",{className:"text-gray-700 mt-1",children:C.message}),w[23]=C.message,w[24]=u):u=w[24],w[25]!==m||w[26]!==b||w[27]!==u?(h=(0,t.jsxs)("div",{className:"flex-1",children:[m,b,u]}),w[25]=m,w[26]=b,w[27]=u,w[28]=h):h=w[28],w[29]!==h||w[30]!==n?(p=(0,t.jsx)("div",{className:"flex items-start justify-between mb-3",children:(0,t.jsxs)("div",{className:"flex items-start gap-3 flex-1",children:[n,h]})}),w[29]=h,w[30]=n,w[31]=p):p=w[31],w[32]!==C.context||w[33]!==S?(y=C.context&&Object.keys(C.context).length>0&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("button",{onClick:()=>E(!S),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:S?"Hide details ▲":"Show details ▼"}),S&&(0,t.jsx)("div",{className:"mt-3 bg-white rounded-lg border border-gray-200 p-4",children:(0,t.jsx)("dl",{className:"grid grid-cols-2 gap-x-4 gap-y-2 text-sm",children:Object.entries(C.context).map(r)})})]}),w[32]=C.context,w[33]=S,w[34]=y):y=w[34],w[35]!==C.status||w[36]!==k||w[37]!==R?(v="TRIGGERED"===C.status&&(0,t.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>k("acknowledge"),disabled:R,className:"px-4 py-2 bg-yellow-600 text-white rounded-lg text-sm font-medium hover:bg-yellow-700 disabled:opacity-50 disabled:cursor-not-allowed",children:R?"Updating...":"Acknowledge"}),(0,t.jsx)("button",{onClick:()=>k("resolve"),disabled:R,className:"px-4 py-2 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:R?"Updating...":"Resolve"}),(0,t.jsx)("button",{onClick:()=>k("dismiss"),disabled:R,className:"px-4 py-2 bg-gray-600 text-white rounded-lg text-sm font-medium hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:R?"Updating...":"Dismiss"})]}),w[35]=C.status,w[36]=k,w[37]=R,w[38]=v):v=w[38],w[39]!==C.status||w[40]!==k||w[41]!==R?(j="ACKNOWLEDGED"===C.status&&(0,t.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>k("resolve"),disabled:R,className:"px-4 py-2 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:R?"Updating...":"Resolve"}),(0,t.jsx)("button",{onClick:()=>k("dismiss"),disabled:R,className:"px-4 py-2 bg-gray-600 text-white rounded-lg text-sm font-medium hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:R?"Updating...":"Dismiss"})]}),w[39]=C.status,w[40]=k,w[41]=R,w[42]=j):j=w[42],w[43]!==p||w[44]!==y||w[45]!==v||w[46]!==j?(f=(0,t.jsxs)("div",{className:"p-6",children:[p,y,v,j]}),w[43]=p,w[44]=y,w[45]=v,w[46]=j,w[47]=f):f=w[47],w[48]!==f||w[49]!==$?(N=(0,t.jsx)("div",{className:$,children:f}),w[48]=f,w[49]=$,w[50]=N):N=w[50],N}function r(e){let[s,l]=e;return(0,t.jsxs)("div",{children:[(0,t.jsxs)("dt",{className:"text-gray-500 font-medium",children:[s,":"]}),(0,t.jsx)("dd",{className:"text-gray-900",children:"number"==typeof l&&s.toLowerCase().includes("pct")?`${l.toFixed(1)}%`:"number"==typeof l&&(s.toLowerCase().includes("cpa")||s.toLowerCase().includes("spend")||s.toLowerCase().includes("threshold"))?`$${l.toFixed(2)}`:String(l)})]},s)}let i=[{value:"TRIGGERED",label:"Active",color:"red"},{value:"ACKNOWLEDGED",label:"Acknowledged",color:"yellow"},{value:"RESOLVED",label:"Resolved",color:"green"},{value:"DISMISSED",label:"Dismissed",color:"gray"}],d=[{value:"CRITICAL",label:"Critical",color:"red"},{value:"WARNING",label:"Warning",color:"orange"},{value:"INFO",label:"Info",color:"blue"}];function n(e){let s,a,r,n,o,c,x,g,m,b,u,h=(0,l.c)(27),{statusFilter:p,severityFilter:y,onStatusFilterChange:v,onSeverityFilterChange:j}=e;h[0]!==v||h[1]!==p?(s=e=>{p.includes(e)?v(p.filter(t=>t!==e)):v([...p,e])},h[0]=v,h[1]=p,h[2]=s):s=h[2];let f=s;h[3]!==j||h[4]!==y?(a=e=>{y.includes(e)?j(y.filter(t=>t!==e)):j([...y,e])},h[3]=j,h[4]=y,h[5]=a):a=h[5];let N=a;h[6]===Symbol.for("react.memo_cache_sentinel")?(r=(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),h[6]=r):r=h[6],h[7]!==p||h[8]!==f?(n=i.map(e=>(0,t.jsx)("button",{onClick:()=>f(e.value),className:`px-3 py-1.5 text-sm rounded-lg border transition-colors ${p.includes(e.value)?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:e.label},e.value)),h[7]=p,h[8]=f,h[9]=n):n=h[9],h[10]!==n?(o=(0,t.jsxs)("div",{children:[r,(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:n})]}),h[10]=n,h[11]=o):o=h[11],h[12]===Symbol.for("react.memo_cache_sentinel")?(c=(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Severity"}),h[12]=c):c=h[12],h[13]!==j?(x=()=>j([]),h[13]=j,h[14]=x):x=h[14];let w=`px-3 py-1.5 text-sm rounded-lg border transition-colors ${0===y.length?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`;return h[15]!==x||h[16]!==w?(g=(0,t.jsx)("button",{onClick:x,className:w,children:"All"}),h[15]=x,h[16]=w,h[17]=g):g=h[17],h[18]!==y||h[19]!==N?(m=d.map(e=>(0,t.jsx)("button",{onClick:()=>N(e.value),className:`px-3 py-1.5 text-sm rounded-lg border transition-colors ${y.includes(e.value)?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:e.label},e.value)),h[18]=y,h[19]=N,h[20]=m):m=h[20],h[21]!==m||h[22]!==g?(b=(0,t.jsxs)("div",{children:[c,(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[g,m]})]}),h[21]=m,h[22]=g,h[23]=b):b=h[23],h[24]!==b||h[25]!==o?(u=(0,t.jsx)("div",{className:"bg-white rounded-lg shadow p-4",children:(0,t.jsxs)("div",{className:"flex flex-wrap gap-6",children:[o,b]})}),h[24]=b,h[25]=o,h[26]=u):u=h[26],u}function o(){let[e,l]=(0,s.useState)([]),[r,i]=(0,s.useState)(!0),[d,o]=(0,s.useState)(["TRIGGERED","ACKNOWLEDGED"]),[c,x]=(0,s.useState)([]),[g,m]=(0,s.useState)(0);(0,s.useEffect)(()=>{b()},[d,c]);let b=async()=>{i(!0);try{let e=new URLSearchParams;d.length>0&&e.set("status",d.join(",")),c.length>0&&e.set("severity",c.join(","));let t=await fetch(`/api/alerts?${e}`);if(t.ok){let e=await t.json();l(e.data||[]),m(e.pagination?.total||0)}}catch(e){console.error("Failed to fetch alerts:",e)}finally{i(!1)}},u=async(e,t)=>{try{(await fetch("/api/alerts",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({alertId:e,action:t})})).ok&&b()}catch(e){console.error("Failed to update alert:",e)}},h=e.filter(e=>"TRIGGERED"===e.status).length,p=e.filter(e=>"CRITICAL"===e.severity&&"TRIGGERED"===e.status).length;return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Alerts"}),(0,t.jsx)("p",{className:"text-gray-600 mt-1",children:h>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"font-semibold text-red-600",children:h})," active alert",1!==h?"s":"",p>0&&(0,t.jsxs)("span",{className:"ml-2",children:["(",(0,t.jsx)("span",{className:"font-semibold text-red-700",children:p})," critical)"]})]}):"No active alerts"})]}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)("span",{className:"text-sm text-gray-500",children:["Total: ",g]})})]})})}),(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsx)(n,{statusFilter:d,severityFilter:c,onStatusFilterChange:o,onSeverityFilterChange:x}),(0,t.jsx)("div",{className:"mt-6 space-y-4",children:r?(0,t.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0].map((e,s)=>(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 animate-pulse",children:[(0,t.jsx)("div",{className:"h-6 bg-gray-200 rounded w-3/4 mb-2"}),(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]},s))}):0===e.length?(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"All Clear!"}),(0,t.jsx)("p",{className:"text-gray-600",children:"No alerts match your current filters"})]}):e.map(e=>(0,t.jsx)(a,{alert:e,onStatusUpdate:u},e.id))})]})]})}e.s(["AlertsInbox",()=>o],13185)}]);